<!DOCTYPE html>
<html>
    <head>
        <title>BYU AWS Account Structure</title>
        <link rel="stylesheet" type="text/css" href="styles.css">
    </head>
    <body>

        <svg width="1400" height="25" id="vpn-tunnel">
            <polygon points="1,1 1399,1 1399,24 1,24 1,1" style="fill:#0062B8;stroke:black;stroke-width:3;"/>
            <text x="770" y="19" style="fill:white;font-size:20px;font-weight:bold;">Virtual Private Network (VPN)</text>
        </svg>
        <svg width="26" height="14" class="arrow" id="vpn-nat-arrow">
            <polygon points="1,4 18,4 18,1 25,7 18,13 18,10 1,10 1,4" style="fill:red;stroke:black;stroke-width:1;"/>
            <text x="5" y="9" style="fill:white;font-size:5px;font-weight:bold;">NAT</text>
        </svg>
        <svg width="26" height="14" class="arrow" id="nat-arrow">
            <polygon points="1,4 18,4 18,1 25,7 18,13 18,10 1,10 1,4" style="fill:red;stroke:black;stroke-width:1;"/>
            <text x="5" y="9" style="fill:white;font-size:5px;font-weight:bold;">NAT</text>
        </svg>
        <svg width="26" height="14" class="arrow" id="byu-arrow">
            <polygon points="1,4 18,4 18,1 25,7 18,13 18,10 1,10 1,4" style="fill:red;stroke:black;stroke-width:1;" transform="rotate(180) translate(-26,-14)"/>
            <text x="10" y="9" style="fill:white;font-size:5px;font-weight:bold;">NAT</text>
        </svg>
        <svg width="33" height="14" class="arrow" id="vpn-public-arrow">
            <polygon points="1,7 8,1 8,4 25,4 25,1 32,7 25,13 25,10 8,10 8,13 1,7" style="fill:red;stroke:black;stroke-width:1;"/>
        </svg>
        <svg width="33" height="14" class="arrow" id="public-arrow">
            <polygon points="1,7 8,1 8,4 25,4 25,1 32,7 25,13 25,10 8,10 8,13 1,7" style="fill:red;stroke:black;stroke-width:1;"/>
        </svg>
        <svg width="14" height="33" class="arrow-p" id="peering-arrow">
            <polygon points="7,1 1,8 4,8 4,25 1,25 7,32 13,25 10,25 10,8 13,8 7,1" style="fill:red;stroke:black;stroke-width:1;"/>
        </svg>
        <svg width="14" height="33" class="vpn-arrow-v" id="vpn-data-arrow">
            <polygon points="7,1 1,8 4,8 4,25 1,25 7,32 13,25 10,25 10,8 13,8 7,1" style="fill:red;stroke:black;stroke-width:1;"/>
        </svg>
        <svg width="14" height="33" class="vpn-arrow-v" id="vpn-private-arrow">
            <polygon points="7,1 1,8 4,8 4,25 1,25 7,32 13,25 10,25 10,8 13,8 7,1" style="fill:red;stroke:black;stroke-width:1;"/>
        </svg>
        <svg width="14" height="33" class="vpn-arrow-v" id="vpn-byu-arrow">
            <polygon points="7,1 1,8 4,8 4,25 1,25 7,32 13,25 10,25 10,8 13,8 7,1" style="fill:red;stroke:black;stroke-width:1;"/>
        </svg>
        <div id="aws-region">
            <span class="title" id="region-title">AWS Region</span>
            <div id="vpn-vpc" class="vpc">
                <svg width="33" height="14" class="small-arrow-h" id="route-private-data-arrow">
                    <polygon points="1,7 8,1 8,4 25,4 25,1 32,7 25,13 25,10 8,10 8,13 1,7" style="fill:red;stroke:black;stroke-width:1;"/>
                </svg>
                <svg width="14" height="33" class="small-arrow-v" id="route-public-data-arrow">
                    <polygon points="7,1 1,8 4,8 4,25 1,25 7,32 13,25 10,25 10,8 13,8 7,1" style="fill:red;stroke:black;stroke-width:1;"/>
                </svg>
                <svg width="14" height="33" class="small-arrow-v" id="route-public-private-arrow">
                    <polygon points="7,1 1,8 4,8 4,25 1,25 7,32 13,25 10,25 10,8 13,8 7,1" style="fill:red;stroke:black;stroke-width:1;"/>
                </svg>
                <span class="title" id="vpc-title">VPN-VPC - 10.a.b.c</span>
                <div class="subnets" id="public-subnets">
                    <span class="title" id="subnet-title">VPN Public Subnets</span>
                    <div class="subnet" id="public-a">vpn-public-a</div>
                    <div class="subnet" id="public-b">vpn-public-b</div>
                </div>
                <div class="subnets royal" id="private-subnets">
                    <span class="title" id="subnet-title">VPN Private Subnets</span>
                    <div class="subnet navy" id="private-a">vpn-private-a</div>
                    <div class="subnet navy" id="private-b">vpn-private-b</div>
                </div>
                <div class="subnets royal" id="data-subnets">
                    <span class="title" id="subnet-title">VPN Data Subnets</span>
                    <div class="subnet navy" id="data-a">vpn-data-a</div>
                    <div class="subnet navy" id="data-b">vpn-data-b</div>
                </div>
            </div>
            <div id="vpc" class="vpc">
                <svg width="33" height="14" class="small-arrow-h" id="route-private-data-arrow">
                    <polygon points="1,7 8,1 8,4 25,4 25,1 32,7 25,13 25,10 8,10 8,13 1,7" style="fill:red;stroke:black;stroke-width:1;"/>
                </svg>
                <svg width="14" height="33" class="small-arrow-v" id="route-public-data-arrow">
                    <polygon points="7,1 1,8 4,8 4,25 1,25 7,32 13,25 10,25 10,8 13,8 7,1" style="fill:red;stroke:black;stroke-width:1;"/>
                </svg>
                <svg width="14" height="33" class="small-arrow-v" id="route-public-private-arrow">
                    <polygon points="7,1 1,8 4,8 4,25 1,25 7,32 13,25 10,25 10,8 13,8 7,1" style="fill:red;stroke:black;stroke-width:1;"/>
                </svg>
                <span class="title" id="vpc-title">VPC - 172.x.y.z</span>
                <div class="subnets" id="public-subnets">
                    <span class="title" id="subnet-title">Public Subnets</span>
                    <div class="subnet" id="public-a">public-a</div>
                    <div class="subnet" id="public-b">public-b</div>
                </div>
                <div class="subnets" id="private-subnets">
                    <span class="title" id="subnet-title">Private Subnets</span>
                    <div class="subnet" id="private-a">private-a</div>
                    <div class="subnet" id="private-b">private-b</div>
                </div>
                <div class="subnets" id="data-subnets">
                    <span class="title" id="subnet-title">Data Subnets</span>
                    <div class="subnet" id="data-a">data-a</div>
                    <div class="subnet" id="data-b">data-b</div>
                </div>
            </div>
        </div>
        <div id="internet">Internet</div>
        <div id="byu"><img src="byu.png"></div>
        <div id="byu-infrastructure">
            <h1>BYU AWS Infrastructure</h1>
            <p>
                Our aim is to create <em>small</em> accounts which contain one application or a small number of interrelated applications. 
                This enables you to give account access only to those involved in creating/maintaining the application(s).
            </p>
            <p>
                We use Single Sign On (SSO) to administer access to individual accounts. Account access is managed via <a href="https://gro.byu.edu/" target="_blank">GRO</a>. 
                When you request an account, a GRO group will also be created to allow you to control access to the account. Users sign in with their NetId/Password. 
                Duo multifactor authentication (MFA) is required.<br>
                <a href="https://awslogin.byu.edu/" target="_blank">https://awslogin.byu.edu/</a>
            </p>
            <p>
                AWS has infrastructure in many <em>regions</em> around the world. At BYU we generally use the <strong>Oregon Region</strong> and the <strong>Virginia Region</strong>.
                Each <em>region</em> has multiple geographically isolated data centers referred to as Availability Zones. Each of our subnet types is divided across 2 Availability Zones
                to enable the creation of resilient applications.<br>
                BYU accounts are connected to four Virtual Private Clouds (<strong>VPC</strong>) or Virtual Data Centers. 
                    <ul>
                        <li>vpn-oregon</li>
                        <li>vpn-virginia</li>
                        <li>oregon</li>
                        <li>virginia</li>
                    </ul>
                VPCs prefixed<sup>&dagger;</sup> with <strong>vpn</strong> are connected via <em>Virtual Private Network</em> to BYU. Subnets in AWS which are routed over the VPN operate like
                an extension of BYU's network.<br>
                <pre><sup>&dagger;</sup> To increase security, only <em>data</em> and <em>private</em> subnets are routed to BYU via the VPN.</pre>
                As there are a limited number of VPN routable IP addresses - spread across production and development accounts for both OIT and BYU Departments - it is important
                to conserve them when possible.<br>
                <b>If your AWS infrastructure does not need direct access to campus in order to function, please use the non-VPN VPC.</b>
            </p>
            <p><h3>Public Subnets</h3>
                Public Subnets have a direct connection to the internet. Infrastructure in these subnets can be accessed directly from the internet.<br>
                Public subnets should contain load balancers and bastion servers. Load Balancers are managed by AWS and can pass internet requests to your 
                infrastructure in private subnets. Bastion servers enable specific users/ports access to infrastructure in more secure (data and private) subnets.
            </p>
            <p><h3>Private Subnets</h3>
                Private Subnets have NAT (Network Address Translation) access to the internet. They can access the internet for updates/downloads but are not 
                directly accessible from the internet.<br>
                Most of your infrastructure should be placed in these subnets.
            </p>
            <p><h3>Data Subnets</h3>
                Data Subnets have no access to the internet. They are specifically designed to contain AWS managed databases which do not need 
                the internet to access updates. In non-VPN data subnets, a bastion server will be needed to access infrastructure during setup. 
            </p>
            <h2>FYI</h2>
            <p><h3>Savings</h3>
                When an account is requested, we create both a <em>production</em> and a matching <em>development</em> account. You are responsible for the cost 
                of infrastructure you create in both accounts.<br>
                BYU purchases <em>savings plans</em> and <em>reserved instances</em>, and receives bulk discounts. These savings are spread across all accounts 
                under the BYU organization.
            </p>

            <p><h3>Security Groups</h3>
                VPC infrastructure like Databases (RDS) and Virtual Machines (EC2) are firewalled. Allowing access to this infrastructure is achieved via security groups.
                A security group is a list of rules for <em>who</em> and <em>what</em> can access the infrastructure.<br>
                <strong>Gotcha: </strong> When creating a Linux EC2 instance, the default security group allows SSH (secure shell) access from 0.0.0.0/0 - this enables access from anywhere in the world, 
                which is a security concern. SSH and RDP (remote desktop protocol) with access to the world will be automatically remediated by our security tool.<br>
                When creating security groups, always consider <em>least privilege</em>. 
            </p>
            <p><h3>HTTPS SSL Certificates</h3>
                When accounts are set up, we automatically create a DNS record for the domain <em>accountname.amazon.byu.edu</em>. We also create SSL certificates in Oregon and Virginia 
                for use with this domain and any of its subdomains.
            </p>
            <p><h3>Training Account</h3>
                We have attempted to give as much access as possible to the <em>PowerUser Role</em>. The main limitation is the requirement to add a Permissions Boundary when attaching
                a policy to a role.<br>
                On occasion, you may want to test something with the <em>Admin Role</em>. We provide the byu-org-trn account for this purpose. If at anytime you need access
                to this account, you can visit <a href="http://go.byu.edu/AWSTrainingAccountRequest" target="_blank">http://go.byu.edu/AWSTrainingAccountRequest</a>. 
            </p>
            <p><h3>Infrastructure As Code (IAC)</h3>
                We recommend when creating infrastructure in AWS that you use a tool like <em>AWS CloudFormation</em> or <em>Terraform by Hashicorp</em>. IAC simplifies the creation
                of matching infrastructure between development and production accounts. Code changes can be tracked in Git.<br>
                The Office of IT uses Terraform, and is creating modules to simplify deployment of standard infrastructure without the need to reinvent the wheel.   
            </p>
        </div>
    </body>
</html>
